const modalWindow=document.querySelector(".modal-window"),modalWindowBtn=document.querySelector(".modal-window__button"),startPayment=document.querySelector(".start-payment-button"),budgetValue=document.querySelector(".budget-value"),dayBudgetValue=document.querySelector(".daybudget-value"),levelValue=document.querySelector(".level-value"),expensesValue=document.querySelector(".expenses-value");var optionalExpensesItems=document.querySelectorAll(".optional-expenses__enter-item");const incomeValue=document.querySelector(".income-value"),monthSavingsValue=document.querySelector(".monthsavings-value"),yearSavingsValue=document.querySelector(".yearsavings-value");var expensesItems=document.querySelectorAll(".expenses__enter-item");const expensesItemBtn=document.querySelector(".expenses__button"),optionalExpensesBtn=document.querySelector(".optional-expenses__button"),optionalExpensesValue=document.querySelector(".optionalexpenses-value"),chooseIncome=document.querySelector(".income__enter"),checkSavings=document.querySelector(".check-savings"),sum=document.querySelector(".sum"),percent=document.querySelector(".percent"),year=document.querySelector(".data__year"),month=document.querySelector(".data__month"),day=document.querySelector(".data__day");let money,time;expensesItemBtn.disabled=!0,optionalExpensesBtn.disabled=!0;for(let e of optionalExpensesItems)e.disabled=!0;for(let e of expensesItems)e.disabled=!0;chooseIncome.disabled=!0,checkSavings.disabled=!0,sum.disabled=!0,percent.disabled=!0,chooseIncome.addEventListener("input",(function(){let e=chooseIncome.value;appData.income=e.split(", "),incomeValue.textContent=appData.income})),checkSavings.addEventListener("click",(function(){sum.disabled=!1,percent.disabled=!1,appData.savings?appData.savings=!1:appData.savings=!0})),sum.addEventListener("input",(function(){if(appData.savings){let e=+sum.value,t=+percent.value;appData.monthIncome=e/100/12*t,appData.yearIncome=e/100*t,monthSavingsValue.textContent=appData.monthIncome.toFixed(1),yearSavingsValue.textContent=appData.yearIncome.toFixed(1)}})),percent.addEventListener("input",(function(){if(appData.savings){let e=+sum.value,t=+percent.value;appData.monthIncome=e/100/12*t,appData.yearIncome=e/100*t,monthSavingsValue.textContent=appData.monthIncome.toFixed(1),yearSavingsValue.textContent=appData.yearIncome.toFixed(1)}}));let appData={budget:money,expenses:{},optionalExpenses:{},income:[],timeData:time,savings:!1};var regExPData=/[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])/;let modalTime=document.querySelector(".modal-window__date"),modalMoney=document.querySelector(".modal-window__budget"),tooltip=document.querySelectorAll(".tooltip");function countMoney(){let e=0;expensesItems=document.querySelectorAll(".expenses__enter-item"),console.log(expensesItems.length),console.log(expensesItems);for(let t=0;t<expensesItems.length;t++){let n=expensesItems[t].value,o=expensesItems[++t].value;"string"==typeof n&&null!==typeof n&&null!==typeof o&&""!==n&&""!==o&&n.length<50?(console.log("done"),appData.expenses[n]=o,e+=+o):t--}expensesValue.textContent=e,determineLevel()}function determineLevel(){null!=appData.budget?(appData.moneyPerDay=((appData.budget-+expensesValue.textContent)/30).toFixed(1),dayBudgetValue.textContent=appData.moneyPerDay,appData.moneyPerDay<100?levelValue.textContent="Минимальный уровень достатка":appData.moneyPerDay>100&&appData.moneyPerDay<2e3?levelValue.textContent="Средний уровень достатка":appData.moneyPerDay>2e3?levelValue.textContent="Высокий уровень достатка":levelValue.textContent="Error"):dayBudgetValue.textContent="Произошла ошибка"}startPayment.addEventListener("click",(function(){modalWindow.style.display="block",time=document.querySelector(".modal-window__date").value,money=+document.querySelector(".modal-window__budget").value,modalWindowBtn.addEventListener("click",(function(){time=document.querySelector(".modal-window__date").value,money=+document.querySelector(".modal-window__budget").value,time.match(regExPData)&&"number"==typeof money&&0!==money?(console.log(!0),modalWindow.style.display="none",tooltip[0].style.display="none",tooltip[1].style.display="none",appData.budget=money,appData.timeData=time,budgetValue.textContent=money.toFixed(),year.value=new Date(Date.parse(time)).getFullYear(),month.value=new Date(Date.parse(time)).getMonth()+1,day.value=new Date(Date.parse(time)).getDate(),determineLevel()):null!=time.match(regExPData)||"number"==typeof money&&0!==money?null==time.match(regExPData)?(console.log("data false"),tooltip[0].style.display="inline-block",tooltip[1].style.display="none"):"number"==typeof money&&0!==money||(console.log("money false"),tooltip[0].style.display="none",tooltip[1].style.display="inline-block"):(console.log("money & data false"),tooltip[0].style.display="inline-block",tooltip[1].style.display="inline-block")})),appData.budget=money,appData.timeData=time,budgetValue.textContent=money.toFixed(),year.value=new Date(Date.parse(time)).getFullYear(),month.value=new Date(Date.parse(time)).getMonth()+1,day.value=new Date(Date.parse(time)).getDate(),expensesItemBtn.disabled=!1,optionalExpensesBtn.disabled=!1,chooseIncome.disabled=!1,checkSavings.disabled=!1;for(let e of optionalExpensesItems)e.disabled=!1;for(let e of expensesItems)e.disabled=!1;const e=document.querySelector(".add-expenses"),t=document.querySelector(".input-delete"),n=document.querySelector(".add-optional-expenses"),o=document.querySelector(".delete-optional-expenses"),a=document.querySelector(".expenses__enter-items"),l=document.querySelector(".optional-expenses__enter-items");e.addEventListener("click",(function(){t.style.display="flex",t.classList.add("delete-expenses");let e=document.createElement("input"),n=document.createElement("input");e.classList.add("expenses__enter-item"),e.classList.add("enter-item"),e.placeholder="Наименование",a.appendChild(e),n.classList.add("expenses__enter-item"),n.classList.add("enter-item"),n.placeholder="Цена",n.type="number",a.appendChild(n),t.addEventListener("click",(function(){a.removeChild(e),a.removeChild(n),t.style.display="none",console.log(appData.expenses);const o=Object.keys(appData.expenses)[Object.keys(appData.expenses).length-1];console.log(appData.expenses[o]),expensesItems=document.querySelectorAll(".expenses__enter-item"),delete appData.expenses[o],countMoney()}))})),n.addEventListener("click",(function(){o.style.display="flex",o.classList.add("delete-expenses");let e=document.createElement("input");e.classList.add("optional-expenses__enter-item"),e.classList.add("enter-item"),l.appendChild(e),optionalExpensesItems=document.querySelectorAll(".optional-expenses__enter-item"),console.log(optionalExpensesValue.textContent),optionalExpensesObj=Object.assign({},appData.optionalExpenses),optionalTextContent=Object.values(optionalExpensesObj).join(" "),optionalExpensesValue.textContent=optionalTextContent,o.addEventListener("click",(function(){l.removeChild(e),o.style.display="none";const t=Object.keys(appData.optionalExpenses)[Object.keys(appData.optionalExpenses).length-1];console.log(t),optionalExpensesItems=document.querySelectorAll(".optional-expenses__enter-item"),delete appData.optionalExpenses[t],optionalExpensesObj=Object.assign({},appData.optionalExpenses),optionalTextContent=Object.values(optionalExpensesObj).join(" "),optionalExpensesValue.textContent=optionalTextContent}))})),determineLevel()})),expensesItemBtn.addEventListener("click",(function(){countMoney()}));var optionalExpensesObj=Object.assign({},appData.optionalExpenses),optionalTextContent=Object.values(optionalExpensesObj).join(" ");optionalExpensesBtn.addEventListener("click",(function(){for(let e=0;e<optionalExpensesItems.length;e++){let t=optionalExpensesItems[e].value;appData.optionalExpenses[e]=t,optionalExpensesValue.textContent+=appData.optionalExpenses[e]+" "}optionalExpensesObj=Object.assign({},appData.optionalExpenses),optionalTextContent=Object.values(optionalExpensesObj).join(" "),optionalExpensesValue.textContent=optionalTextContent,console.log("click")}));